---
/**
 * ─── Dynamic Page Route ───
 * Generates a page for each entry in the "pages" content collection.
 * Handles: /nosotros, /servicios, /contacto, etc.
 */
import PageLayout from "@layouts/PageLayout.astro";
import { getCollection } from "astro:content";

export async function getStaticPaths() {
  const pages = await getCollection("pages");
  return pages.map((page) => ({
    params: { slug: page.slug },
    props: page,
  }));
}

const page = Astro.props;
const { Content } = await page.render();
---

<PageLayout
  title={page.data.title}
  description={page.data.description}
  image={page.data.image}
  noindex={page.data.noindex}
>
  <!-- Simple Hero Section -->
  {page.data.hero && (
    <section class="page-hero">
      <div class="container">
        <h1 class="page-hero__title">{page.data.hero.title}</h1>
        {page.data.hero.description && (
          <p class="page-hero__desc">{page.data.hero.description}</p>
        )}
        <div class="page-hero__actions">
          {page.data.hero.primaryCTA && (
            <a href={page.data.hero.primaryCTA.href} class="btn btn--primary">
              {page.data.hero.primaryCTA.label}
            </a>
          )}
          {page.data.hero.secondaryCTA && (
            <a href={page.data.hero.secondaryCTA.href} class="btn btn--ghost">
              {page.data.hero.secondaryCTA.label}
            </a>
          )}
        </div>
      </div>
    </section>
  )}

  <!-- Page Content -->
  <section class="section">
    <div class="container container--narrow prose">
      <Content />
    </div>
  </section>
</PageLayout>

<style>
  .page-hero {
    padding: var(--space-16) 0;
    background: var(--color-smoke-950);
    text-align: center;
  }

  .page-hero__title {
    font-size: clamp(2rem, 4vw, 3rem);
    font-weight: 800;
    color: white;
    margin: 0 0 var(--space-4);
  }

  .page-hero__desc {
    font-size: var(--text-lg);
    color: var(--color-smoke-300);
    max-width: 640px;
    margin: 0 auto var(--space-8);
  }

  .page-hero__actions {
    display: flex;
    justify-content: center;
    gap: var(--space-4);
    flex-wrap: wrap;
  }
</style>
